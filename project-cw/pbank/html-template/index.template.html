<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!--  BEGIN Browser History required section -->
<link rel="stylesheet" type="text/css" href="history/history.css" />
<!--  END Browser History required section -->
<title>${title}</title>
<script src="AC_OETags.js" language="javascript"></script>
<!--  BEGIN Browser History required section -->
<script src="history/history.js" language="javascript"></script>
<!--  END Browser History required section -->
<style>
body { margin: 0px; overflow:hidden }
</style>
<script language="JavaScript" type="text/javascript">
<!--
// -----------------------------------------------------------------------------
// Globals
// Major version of Flash required
var requiredMajorVersion = ${version_major};
// Minor version of Flash required
var requiredMinorVersion = ${version_minor};
// Minor version of Flash required
var requiredRevision = ${version_revision};
// -----------------------------------------------------------------------------
// -->
</script>
<script language=javascript src="scorm/APIWrapper.js"></script>
<script language=javascript src="scorm/SCOFunctions.js"></script>
<SCRIPT LANGUAGE="JavaScript1.2"> 
<!-- 
loadPage(); 
var currentScore = doLMSGetValue("cmi.core.score.raw");
var locationStr = doLMSGetValue("cmi.core.lesson_location");

function window_close()
{
	if(confirm ("您是否退出本课程 ？"))
	{
		top.close();
	}
}

function setScore()
{
	var currentScore=window.document.navigator.GetVariable("current_score");  //由navigator获取current_score的值
	//alert("-----6----setScore:"+currentScore);
	doLMSSetValue("cmi.core.score.raw",currentScore);  
}

function scoFinished()
{
	//alert("-----scoFinished()--------");
	//setLocation();
	doContinue('completed');
}

function nextPage ()
{
	setLocation();
}

function prePage ()
{
	setLocation();
}

function endPage ()
{
	setLocation();
}

function firstPage ()
{
	setLocation();
}

function refresh ()
{
	setLocation();
}

function navigator_DoFSCommand(command, args) 
{ 
   // alert(command+"="+args);	
	if(command == "load_page")
	{
		loadPage();
	}
	if(command == "unload_page")
	{
   		unloadPage();
	}
	if(command == "doContinue")
	{
		doContinue(args);
	}	
	if (command == "quit") {
		//window.close();
		window_close();
	 }
	if (command == "newwindow"){
		setTimeout(args,1);
	}
}

function setLocation()
{
	var currentPage=window.document.navigator.GetVariable("currentPageNum");  //由navigator获取currentPageNum的值
	var currentScore=window.document.navigator.GetVariable("current_score");  //由navigator获取current_score的值	
	//alert("---currentPage:"+currentPage);   
	doLMSSetValue("cmi.core.lesson_location",currentPage);
	//alert("-----currentScore:"+currentScore);   
	doLMSSetValue("cmi.core.score.raw",currentScore);
	computeTime();
}

function exitWin()
{
	setLocation();
	unloadPage();
}
//--> 
</SCRIPT> 

<SCRIPT LANGUAGE="VBScript">
<!-- 
// Catch the fscommand in ie with vbscript, and pass
// it on to JavaScript.

Sub navigator_FSCommand(ByVal command, ByVal args)
    call navigator_DoFSCommand(command, args)
end sub

//-->
</SCRIPT>

</head>

<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onunload="exitWin();">
<script language="JavaScript" type="text/javascript">
<!--
// Version check for the Flash Player that has the ability to start Player Product Install (6.0r65)
var hasProductInstall = DetectFlashVer(6, 0, 65);

// Version check based upon the values defined in globals
var hasRequestedVersion = DetectFlashVer(requiredMajorVersion, requiredMinorVersion, requiredRevision);

if ( hasProductInstall && !hasRequestedVersion ) {
	// DO NOT MODIFY THE FOLLOWING FOUR LINES
	// Location visited after installation is complete if installation is required
	var MMPlayerType = (isIE == true) ? "ActiveX" : "PlugIn";
	var MMredirectURL = window.location;
    document.title = document.title.slice(0, 47) + " - Flash Player Installation";
    var MMdoctitle = document.title;

	AC_FL_RunContent(
		"src", "playerProductInstall",
		"FlashVars", "MMredirectURL="+MMredirectURL+'&MMplayerType='+MMPlayerType+'&MMdoctitle='+MMdoctitle+"",
		"width", "${width}",
		"height", "${height}",
		"align", "middle",
		"id", "${application}",
		"quality", "high",
		"bgcolor", "${bgcolor}",
		"name", "${application}",
		"allowScriptAccess","sameDomain",
		//"allowFullScreen","true",
		//"wmode","transparent",
		"type", "application/x-shockwave-flash",
		"pluginspage", "http://www.adobe.com/go/getflashplayer"
	);
} else if (hasRequestedVersion) {
	// if we've detected an acceptable version
	// embed the Flash Content SWF when all tests are passed
	AC_FL_RunContent(
			"src", "${swf}",
			"width", "${width}",
			"height", "${height}",
			"align", "middle",
			"id", "${application}",
			"quality", "high",
			"bgcolor", "${bgcolor}",
			"name", "${application}",
			"allowScriptAccess","sameDomain",
			//"allowFullScreen","true",
			//"wmode","transparent",
			//"allowNetworking","all",
			"type", "application/x-shockwave-flash",
			"pluginspage", "http://www.adobe.com/go/getflashplayer"
	);
  } else {  // flash is too old or we can't detect the plugin
    var alternateContent = 'Alternate HTML content should be placed here. '
  	+ 'This content requires the Adobe Flash Player. '
   	+ '<a href=http://www.adobe.com/go/getflash/>Get Flash</a>';
    document.write(alternateContent);  // insert non-flash content
  }
//-->
</script>
<noscript>
  	<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
			id="${application}" width="${width}" height="${height}"
			codebase="http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab">
			<param name="movie" value="${swf}.swf?locationStr=" + locationStr />
			<param name="quality" value="high" />
			<param name="bgcolor" value="${bgcolor}" />
			<param name="allowScriptAccess" value="sameDomain" />	
			<embed src="${swf}.swf?locationStr=" + locationStr quality="high" bgcolor="${bgcolor}"
				width="${width}" height="${height}" name="${application}" align="middle"
				play="true"
				loop="false"
				quality="high"
				allowScriptAccess="sameDomain"							
				type="application/x-shockwave-flash"
				pluginspage="http://www.adobe.com/go/getflashplayer">
			</embed>
	</object>
</noscript>
</body>
</html>